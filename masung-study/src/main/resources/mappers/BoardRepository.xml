<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.czo.masung.board.repository.BoardRepository">
	
	<select id="getList" resultType="com.czo.masung.board.model.vo.BoardVO">
		SELECT 
			b.* 
		FROM Boards b INNER JOIN Users u ON b.user_id = u.user_id
		<!-- <include refid="search"/>    검색 구현중  -->
		order by board_number desc
		limit #{skip}, #{size}
	</select>

	<select id="getTotalCount" resultType="int">
		SELECT count(*) FROM Boards b INNER JOIN Users u ON b.user_id = u.user_id
	</select>	

	<select id="getRead" resultType="com.czo.masung.board.model.vo.BoardVO">
		SELECT * FROM Boards where board_number = #{board_number}
	</select>	
	
	<delete id="remove" >
		delete FROM Boards where board_number = #{board_number}
	</delete>
	
	<update id="modify" parameterType="com.czo.masung.board.model.vo.BoardVO">
		update Boards set 
			  board_title    = #{board_title}
			, board_content  = #{board_content}
			, board_category_number = #{board_category_number}
			, board_last_updated = NOW()
		where board_number = #{board_number}
	</update>
	
	<insert id="register" useGeneratedKeys="true" keyProperty="board_number">
		insert into Boards (
			 user_id
			,board_title
			,board_content
			,board_viewcnt
			,parent_board_number
			,board_category_number
		) values (
			 #{user_id}
			,#{board_title}
			,#{board_content}
			,#{board_viewcnt}
			,#{parent_board_number}
			,#{board_category_number}
		)
	</insert>

</mapper>	
